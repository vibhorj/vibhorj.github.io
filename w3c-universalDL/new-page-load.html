<!DOCTYPE html>
<html>
<head>
<title>Welcome to nginx!</title>
<script>


	dataLayer = window.dataLayer || [];
	dataLayer.push({

		"pageInstanceID": "dev", // "dev", "staging", "prod"

		"page": {

			"pageInfo": {
				"pageID": "316",
				"pageName": "Rogaine Hair Regrowth Treatment",
				"destinationURL": "http://site.com/r.html", // document.location
				"referringURL": "http://www.google.com/url?&q=&esrc=s", // document.referrer,
				"sysEnv": "mobile",
				"variant": "2",
				"version": "1.14",
				"breadCrumbs": ["home","Products","haircare"],
				"author": "J Smith",
				"issueDate": "2013-09-01",
				"effectiveDate": "2013-09-20",
				"expiryDate": "2014-09-20",
				"language": "en-US",
				"geoRegion": "US",
				"industryCodes": "SIC codes",
			}, // "pageInfo" closure

			"category": {
				"primaryCategory": "FAQ Pages",
				"subCategory1": "ProductInfo",
				"pageType": "FAQ"
			}, // "category" closure

			"attributes": {
				// extensibility to the Page object. custom needs...
			}
		}, // "page" closure,


		// IF and ONLY IF user is logged-in
		"user": {

			"profile": {
				"profileInfo": {
					"profileID": "humanbeing12345",
					"userName": "me"
				},
			
				"address": {
					"line1": "673 My Street",
					"line2": "Apt 1",
					"city": "Austin",
					"stateProvince": "TX",
					"postalCode": "78610",
					"country": "USA"			
				},

				"attributes": {
					// extensibility to the profile object. custom needs...
				}
			}, // "profile" closure
			
			"segment": {
				// segmentation information for the user, such as premium versus basic membership,
			}, // "segment" closure

		} // "user" closure
	});
</script>

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P5MB4MW');</script>
<!-- End Google Tag Manager -->
</head>
<body>

	<a href="./index.html"> Back to Universal datalayer specs</a>
	<br>
	<h1>Each page load!</h1>
type <I>dataLayer</I> in browser console

<p>1. actual pageload :: each time a new page loads (excl. new page renders in SPA context)</p>

<PRE><CODE>
	dataLayer = window.dataLayer || [];
	dataLayer.push({

		"pageInstanceID": "dev", // "dev", "staging", "prod"

		"page": <a href="./obj/pageObj.html">pageObj</a>,

		"user": <a href="./obj/userObj.html">userObj</a> // IF and ONLY IF user is logged-in
	});
<br>
</CODE></PRE>
In the special case, a page is a Product details page, or Cart page, or Transaction conformation page: include: <a href="./obj/pageObj.html"><em>productObj</em></a> OR <a href="./obj/cartObj.html"><em>cartObj</em></a> OR <a href="./obj/transactionObj.html"><em>transactionObj</em></a> objects as well. For ex:
	<ul>
	<li> <a href="./product-details-page.html"> Product details page </a> </li>

	<li> <a href="./cart-page.html"> Cart page </a> </li>

	<li> <a href="./transaction-confirm-page.html"> Transaction Confirmation page </a> </li>
</ul>
<hr>
<p>2. virtual page :: new page renders in SPA context ---> just update the new page object with new context, together with additional key <CODE>_clear: true</CODE>, this will clear outdated information in the when context switching between pages (as usual, also include the productObj OR cartObj OR transactionObj depending what the new page context is)


<PRE><CODE>
	dataLayer = window.dataLayer || [];
	dataLayer.push({
		"_clear": true,
		"page": <a href="obj/pageObj.html">pageObj</a> coresponding to new context
	});
</CODE></PRE>

<script>
	function vPV(){
		window.dataLayer.push({
			_clear: true,
			
			"page": {
				
				"pageInfo": {
					// corresponding to new context
				},
				
				"category": {
					// corresponding to new context
				},
				
				"attributes": {
					// corresponding to new context
				}
					
			},

		});
	} 
</script>

<button type = "button" onclick="vPV()">new screen (virtual page)</button>

</body>
</html>
